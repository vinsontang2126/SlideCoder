The code is adopted from LLaMA-Factory.